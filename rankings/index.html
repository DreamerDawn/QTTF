<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>é€‰æ‰‹æ’å - QTTF</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <style>
    :root{
      --bg:#f6f8fb;
      --card:#ffffff;
      --accent:#0066ff;
      --muted:#6b7280;
      --max-width:1200px;
      --stripe:#f9f9f9;
      --line:#e7e7ea;
    }
    html,body{height:100%;margin:0;font-family:Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;color:#0b1220;background:linear-gradient(180deg,#f7fafc 0%, #eef4ff 100%);} 
    a{color:inherit;text-decoration:none}

    header{background:rgba(255,255,255,0.72);-webkit-backdrop-filter: blur(8px);backdrop-filter: blur(8px);box-shadow:0 6px 24px rgba(16,24,40,.06);position:sticky;top:0;z-index:1100;border-bottom:1px solid rgba(15,23,42,.03)}
    .container{max-width:var(--max-width);margin:0 auto;padding:0 28px}
    nav{display:flex;align-items:center;justify-content:space-between;height:64px}
    .brand{font-weight:700;font-size:20px;color:var(--accent)}
    .nav-links{display:flex;gap:20px}
    .nav-links a{color:var(--muted);padding:8px 10px;border-radius:8px;transition:all .18s;font-weight:600}
    .nav-links a:hover{background:rgba(0,102,255,.08);color:var(--accent)}
    .nav-links a.active{color:var(--accent);background:linear-gradient(90deg,rgba(0,102,255,.08),rgba(31,139,255,.06));box-shadow:none;border-radius:10px}

    main{padding:28px 0 56px}

    /* å¸ƒå±€ï¼šä¸»å†…å®¹ 2 / ä¾§è¾¹ 1 */
    .layout{display:grid;grid-template-columns:2fr 1fr;gap:24px;align-items:start}

    /* è¡¨æ ¼æ ·å¼ */
    .table-wrap{background:transparent;padding:10px}
    table.ranking{width:100%;max-width:1200px;margin:8px auto;border-collapse:collapse;font-size:14px}
    table.ranking thead th{background:#f3f6fb;font-weight:700;padding:12px 10px;text-align:center;color:#0b1220;border-bottom:2px solid var(--line)}
    table.ranking thead th.name{ text-align:left }
    table.ranking tbody td{padding:12px 8px;border-bottom:1px solid var(--line);vertical-align:middle}
    table.ranking tbody tr:nth-child(even){background:var(--stripe)}
    table.ranking tbody td.index{width:48px;text-align:center;color:#6b7280}
    table.ranking tbody td.position{width:120px;text-align:center;font-weight:600}
    table.ranking tbody td.difference{text-align:center;width:90px}
    table.ranking tbody td.points{width:100px;text-align:center;padding-right:0;font-variant-numeric:tabular-nums}
    table.ranking tbody td.name{text-align:left;padding-left:10px;color:#d3542a;font-weight:600}

    .diff.up{color:green;font-weight:700}
    .diff.down{color:#d9534f;font-weight:700}
    .diff.new{color:#1e90ff;font-weight:700}

    .card{background:linear-gradient(180deg,#ffffff,#ffffff);padding:14px;border-radius:14px;box-shadow:10px 12px 30px rgba(20,32,78,.04);border:1px solid rgba(15,23,42,.04);box-sizing:border-box}

    .title{font-size:20px;margin:6px 0 12px}
    .note{color:var(--muted);font-size:13px;margin-top:8px}

    /* å†å²å‚èµ›è®°å½•æ ·å¼ */
    .history-card{background:#fff;padding:12px;border-radius:10px;border:1px solid var(--line);}
    .history-table{width:100%;border-collapse:collapse}
    .history-table th{font-weight:700;text-align:left;padding:6px 8px;border-bottom:1px solid var(--line)}
    .history-table td{padding:8px;border-bottom:1px dashed #eee}
    /* å°†å†å²è¡¨æ ¼å†…å®¹å±…ä¸­ï¼Œä¸å¤§æ ‡é¢˜å¯¹é½ */
    .history-table th, .history-table td{ text-align:center }
    .history-table th.event, .history-table td.event{ text-align:left }
    .history-table tr.ok td{background:#ecf9ef} /* éDNP: æµ…ç»¿è‰² */
    .history-table tr.dnp td{background:#fff2f2} /* DNP: æµ…çº¢è‰² */

    /* ä¾§è¾¹æ é“¾æ¥æ ·å¼ */
    .aside-links a{display:block;color:#1e66d6;margin:8px 0;text-decoration:none}
    .aside-links a::before{content:'>> ';color:#1e66d6;margin-right:6px}

    footer{padding:28px 0;text-align:center;color:var(--muted)}

    /* é”™è¯¯æç¤º */
    .error{color:#b00020;background:#fff6f6;border:1px solid #ffd2d2;padding:10px;border-radius:8px;margin:8px 0}
  </style>
</head>
<body>
  <header>
    <div class="container">
      <nav>
        <div style="display:flex;align-items:center;gap:10px">
          <img src="QTTC.svg" alt="QTTC" style="height:40px;display:inline-block;border-radius:8px;object-fit:contain;" />
          <div class="brand">QTTF</div>
        </div>
        <div class="nav-links">
            <a href="https://dreamerdawn.github.io/QTTF/homepage">é¦–é¡µ</a>
            <a href="https://dreamerdawn.github.io/QTTF/events">èµ›äº‹</a>
            <a class="active" href="https://dreamerdawn.github.io/QTTF/rankings">é€‰æ‰‹æ’å</a>
            <a href="https://dreamerdawn.github.io/QTTF/about">å…³äºæˆ‘ä»¬</a>
        </div>
      </nav>
    </div>
  </header>

  <main class="container">
    <div class="title">ğŸ“ æœ€æ–°é€‰æ‰‹æ’åï¼ˆå…¨æ€§åˆ«ç»„ï¼‰</div>
    <div class="layout">
      <div class="table-wrap card">
        <div id="table-area">
          <table class="ranking" aria-describedby="ranking-desc">
            <thead>
              <tr>
                <th>#</th>
                <th class="position">æ’å</th>
                <th>å˜åŒ–</th>
                <th>ç§¯åˆ†</th>
                <th class="name">å§“å</th>
              </tr>
            </thead>
            <tbody id="ranking-body">
              <tr><td colspan="5" style="text-align:center;padding:18px;color:var(--muted)">æ­£åœ¨åŠ è½½æ•°æ®â€¦</td></tr>
            </tbody>
          </table>
        </div>
        <div id="error" style="display:none" class="error">æ•°æ®åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•ã€‚</div>
      </div>

      <aside>
        <div class="card">
          <h3 style="margin:0 0 8px">å†å²æ’å</h3>
          <div class="note aside-links">
            <a href="https://dreamerdawn.github.io/QTTF/rankings/2026-01">2026-01</a>
            <a href="https://dreamerdawn.github.io/QTTF/rankings/2025-11">2025-11</a>
            <a href="https://dreamerdawn.github.io/QTTF/rankings/2025-07">2025-07</a>
            <a href="https://dreamerdawn.github.io/QTTF/rankings/2024-11">2024-11</a>
            <a href="https://dreamerdawn.github.io/QTTF/rankings/2024-10">2024-10</a>
          </div>
        </div>

        <div class="card" style="margin-top:14px">
          <h4 style="margin:0 0 8px">æœ¯è¯­è§£é‡Š</h4>
          <div class="note">
            <div><strong>W(Win)</strong> - é‡‘ç‰Œï¼Œå† å†›</div>
            <div style="margin-top:6px"><strong>F(Final)</strong> - é“¶ç‰Œï¼Œäºšå†›</div>
            <div style="margin-top:6px"><strong>B(Bronze)</strong> - é“œç‰Œï¼Œå­£å†›</div>
            <div style="margin-top:6px"><strong>SF(SemiFinal)</strong> - å››å¼ºï¼Œæ®¿å†›</div>
            <div style="margin-top:6px"><strong>QF(QuarterFinal)</strong> - å…«å¼º</div>
            <div style="margin-top:6px"><strong>R16(Round of 16)</strong> - åå…­å¼º</div>
            <div style="margin-top:6px"><strong>G3L(Group 3rd Last)</strong> - æœªå‡ºçº¿ï¼Œç‰¹æŒ‡å°ç»„ç¬¬ä¸‰å</div>
            <div style="margin-top:6px"><strong>DNP(Did Not Play)</strong> - æœªå‚èµ›</div>
          </div>
        </div>
      </aside>
    </div>
  </main>

  <footer>
    <div class="container">
      <p>æœ¬ç½‘é¡µç”±Github Copilotç”Ÿæˆï¼Œæ•°æ®ç”±ä¸˜ç­ä¹’ä¹“çƒè”åˆä¼šæä¾›</p>
    </div>
  </footer>

  <script>
    // ä»…ä»åŒç›®å½•çš„ rankings.json åŠ è½½æ•°æ®å¹¶æ¸²æŸ“è¡¨æ ¼ï¼ˆç”¨äº GitHub Pagesï¼‰
    document.addEventListener('DOMContentLoaded', ()=>{
      const body = document.getElementById('ranking-body');
      const errorBox = document.getElementById('error');

      function showError(){
        document.getElementById('table-area').style.display = 'none';
        errorBox.style.display = 'block';
      }

      function renderData(data){
        body.innerHTML = '';
        if(!Array.isArray(data) || data.length===0){
          body.innerHTML = '<tr><td colspan="5" style="text-align:center;color:var(--muted);padding:18px">æš‚æ— æ’åæ•°æ®</td></tr>';
          return;
        }
        data.forEach((row, idx)=>{
          const tr = document.createElement('tr');

          const tdIndex = document.createElement('td');
          tdIndex.className = 'index';
          tdIndex.textContent = row.rank != null ? row.rank : (idx+1);
          tr.appendChild(tdIndex);

          const tdPos = document.createElement('td');
          tdPos.className = 'position';
          tdPos.textContent = row.position != null ? row.position : '';
          tr.appendChild(tdPos);

          const tdDiff = document.createElement('td');
          tdDiff.className = 'difference';
          if(row.difference && typeof row.difference === 'string'){
            const val = row.difference.trim();
            if(val.startsWith('â†‘')){
              const span = document.createElement('span');
              span.className = 'diff up';
              span.textContent = val;
              tdDiff.appendChild(span);
            } else if(val.startsWith('â†“')){
              const span = document.createElement('span');
              span.className = 'diff down';
              span.textContent = val;
              tdDiff.appendChild(span);
            } else if(val.toUpperCase() === 'NEW'){
              const span = document.createElement('span');
              span.className = 'diff new';
              span.textContent = 'NEW';
              tdDiff.appendChild(span);
            } else {
              tdDiff.textContent = val;
            }
          } else {
            tdDiff.textContent = '';
          }
          tr.appendChild(tdDiff);

          const tdPoints = document.createElement('td');
          tdPoints.className = 'points';
          tdPoints.textContent = row.points != null ? row.points : '';
          tr.appendChild(tdPoints);

          const tdName = document.createElement('td');
          tdName.className = 'name';
          tdName.textContent = row.name || '';
          tr.appendChild(tdName);

          body.appendChild(tr);
          // è¡Œç‚¹å‡»å±•å¼€å†å²è®°å½•ï¼ˆä½¿ç”¨ row.history æ•°ç»„ï¼‰
          tr.style.cursor = 'pointer';
          tr.addEventListener('click', ()=>{
            const next = tr.nextElementSibling;
            // å¦‚æœå·²å±•å¼€ï¼Œåˆ™æ”¶èµ·
            if(next && next.classList && next.classList.contains('history-row')){
              next.remove();
              return;
            }

            // å¦åˆ™æ’å…¥å†å²è®°å½•è¡Œ
            const hr = document.createElement('tr');
            hr.className = 'history-row';
            const td = document.createElement('td');
            td.colSpan = 5;
            const card = document.createElement('div');
            card.className = 'history-card';

            const history = Array.isArray(row.history) ? row.history : [];
            if(history.length === 0){
              const p = document.createElement('div');
              p.textContent = 'æ— å†å²å‚èµ›è®°å½•ã€‚';
              card.appendChild(p);
            } else {
              const table = document.createElement('table');
              table.className = 'history-table';
              const thead = document.createElement('thead');
              thead.innerHTML = '<tr><th>Event</th><th>Expires on</th><th>Position</th><th>Points</th></tr>';
              table.appendChild(thead);
              const tbodyH = document.createElement('tbody');
              history.forEach(h=>{
                const r = document.createElement('tr');
                // ç‰¹åˆ¤ï¼šè‹¥ position === 'DNP'ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰ï¼Œæ ‡è®°ä¸º dnpï¼Œå¦åˆ™ä¸º ok
                const posVal = (h.position || '').toString();
                if(posVal.toUpperCase() === 'DNP') r.className = 'dnp'; else r.className = 'ok';

                const tdEvent = document.createElement('td'); tdEvent.className = 'event'; tdEvent.textContent = h.event || '';
                const tdExpire = document.createElement('td'); tdExpire.textContent = h.expires_on || '';
                const tdPos = document.createElement('td'); tdPos.textContent = h.position || '';
                const tdPts = document.createElement('td'); tdPts.textContent = h.points != null ? h.points : '';
                r.appendChild(tdEvent); r.appendChild(tdExpire); r.appendChild(tdPos); r.appendChild(tdPts);
                tbodyH.appendChild(r);
              });
              table.appendChild(tbodyH);
              card.appendChild(table);
            }

            td.appendChild(card);
            hr.appendChild(td);
            tr.parentNode.insertBefore(hr, tr.nextSibling);
          });
        });
      }

      // ä»…ä½¿ç”¨åŒç›®å½•çš„ rankings.jsonï¼ˆé€‚ç”¨äº GitHub Pagesï¼‰
      fetch('rankings.json')
        .then(resp=>{
          if(!resp.ok) throw new Error('ç½‘ç»œé”™è¯¯');
          return resp.json();
        })
        .then(data=>{
          renderData(data);
        })
        .catch(err=>{
          console.error('ä» rankings.json åŠ è½½æ•°æ®å¤±è´¥', err);
          showError();
        });
    });
  </script>

  <script>
    // å¯¼èˆªæ‚¬åœé€»è¾‘ï¼šé»˜è®¤é«˜äº®â€œé€‰æ‰‹æ’åâ€ï¼›æ‚¬åœæ—¶ä»…é«˜äº®å½“å‰é¡¹
    (function(){
      const navLinks = document.querySelectorAll('nav .nav-links a');
      if(!navLinks || navLinks.length===0) return;
      const defaultHref = 'https://dreamerdawn.github.io/QTTF/rankings';

      function resetDefault(){
        navLinks.forEach(a=>a.classList.remove('active'));
        const def = Array.from(navLinks).find(a=>a.getAttribute('href')===defaultHref);
        if(def) def.classList.add('active');
      }

      navLinks.forEach(a=>{
        a.addEventListener('mouseenter', ()=>{
          navLinks.forEach(x=>x.classList.remove('active'));
          a.classList.add('active');
        });
      });

      const container = document.querySelector('nav .nav-links');
      if(container) container.addEventListener('mouseleave', ()=> setTimeout(resetDefault,50));
      // åˆå§‹åŒ–
      resetDefault();
    })();
  </script>
</body>
</html>
